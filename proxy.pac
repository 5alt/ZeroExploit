function FindProxyForURL(url, host) {
    var proxy_host = '{{proxy_host}}'
    var proxy_port = {{proxy_port}}

    var whitelist_domain = {{included_host}}
    var blacklist_domain = {{excluded_host}}
    var blacklist_ext = {{filter_file}}

    if (url.substring(0,5)!="http:" && url.substring(0,6)!="https:") return "DIRECT";

    if(blacklist_domain.length){
        for (var i = 0, len = blacklist_domain.length; i < len; i++) {
            if (dnsDomainIs(host, blacklist_domain[i]))
                return 'DIRECT';
        }
    }

    if(whitelist_domain.length){
        for (var i = 0, len = whitelist_domain.length; i < len; i++) {
                if (!dnsDomainIs(host, whitelist_domain[i]))
                    return 'DIRECT';
        }
    }

    if(blacklist_ext.length){
        for (var i = 0, len = blacklist_ext.length; i < len; i++) {
                if (url.toLowerCase().split('?')[0].endsWith(blacklist_ext[i]))
                    return 'DIRECT';
        }
    }

    return "PROXY "+proxy_host+":"+proxy_port+"; DIRECT";

}